# 数据库

### 1、事务隔离级别

- 读未提交（Read Uncommitted）：允许一个事务读取另一个事务尚未提交的数据，可能会出现脏读、不可重复读和幻读问题。

- 读已提交（Read Committed）：一个事务只能读取另一个事务已经提交的数据，避免了脏读问题，但仍有不可重复读和幻读问题。

- 可重复读（Repeatable Read）：一个事务在执行期间看到的数据，总是跟这个事务在启动时看到的数据一致，避免了不可重复读和脏读问题，但仍有幻读问题。

- 序列化（Serializable）：把并发的事务串行执行，避免了脏读、不可重复读和幻读问题，但并发性能较差。

### 2、幻读

幻读问题指的是在数据库事务中，第一次读取了一组数据，之后在同一事务内再次读取相同的数据，却发现这些数据已经被其他事务插入或删除了，导致第二次读取到的数据和第一次读取到的数据不同，就好像出现了幻觉一样，因此称之为幻读。

举个例子，假设一个事务查询了一个年龄大于18岁的学生的信息，然后再次查询时，却发现年龄大于18岁的学生数量比第一次查询多了几个，这就是幻读。

幻读问题通常出现在高并发、大数据量、复杂的SQL查询和DML语句操作下。幻读问题的产生原因是在并发事务的情况下，多个事务同时对同一数据进行更新、删除、插入等操作时，如果没有采用足够严格的隔离级别，就会导致幻读问题的出现。

为了避免幻读问题，需要采用更高的事务隔离级别，比如Serializable级别。此外，也可以使用乐观锁或悲观锁等机制来避免幻读问题的发生。

### 3、MySQL中锁一行数据时如果没有唯一索引，会出现什么情况？

整张表都会被锁

### 4、快照都和当前读

快照读和当前读是数据库中两种不同的读取数据的方式。

快照读又称为一致性非锁定读，它是在某个时间点上获取数据的一个静态视图，是一个快照，不会因为其他事务对该数据的修改而发生变化。快照读不会对读取到的数据加锁，因此可以避免数据的锁定和等待，从而提高并发性能。但是，它可能会读取到未提交的数据，因此不能用于需要读取已提交数据的场景。

当前读是在读取数据时同时锁定所读取的数据，其他的事务只能在当前事务结束后才能对该数据进行修改。当前读分为共享锁和排它锁，共享锁允许其他事务读取该数据，但不允许其他事务修改该数据，而排它锁不允许其他事务同时读取和修改该数据。当前读确保读取的数据是最新的，因此可以用于需要读取已提交数据的场景。但是，当前读会对所读取的数据加锁，因此可能会导致死锁和性能问题。

通常情况下，对于读多写少的场景，快照读可以提高系统的并发性能；而对于写多读少的场景，当前读可以保证数据的一致性和准确性。

### 5、MVCC

MVCC（Multi-Version Concurrency Control）是指多版本并发控制，是数据库中一种常用的并发控制方法。在MVCC中，每个事务都能够看到一个稳定（snapshot）的数据库状态，而不是一个不断变化的实时数据库状态，因此可以实现高并发性能的同时保证数据的一致性。

在MVCC中，每个事务在执行时都会读取数据的一个快照，每个快照都有一个时间戳或者版本号，不同版本的数据会被存储在不同的地方。当一个事务要修改某个数据时，会将当前版本的数据复制一份作为修改前的备份，然后修改这份备份。这样，在同一时间，不同的事务可以看到不同版本的数据，不同版本的数据可以并存，互不影响。

因此，在MVCC中，读取操作和修改操作可以并行执行，提高了并发性能，同时也保证了数据的一致性。

### 6、MySQL如何给用户授权

要给 MySQL 授权给一个用户，可以使用 GRANT 命令来进行授权操作。下面是一个简单的授权示例：

```sql
GRANT privileges ON database.table TO 'username'@'host' IDENTIFIED BY 'password';
```

其中，各个部分的含义如下：
- `privileges`：指定授予的权限，可以是单个权限或多个权限的组合，例如 SELECT、INSERT、UPDATE、DELETE 等。
- `database.table`：指定数据库和表，可以是具体的数据库和表名，或使用通配符 * 表示所有数据库和表。
- `'username'@'host'`：指定用户名和主机名，用于标识用户。用户名可以是现有的用户或新创建的用户，主机名可以是具体的 IP 地址或主机名，也可以使用通配符 % 表示所有主机。
- `IDENTIFIED BY 'password'`：指定用户的密码，用于进行身份验证。密码可以是明文密码或使用函数加密后的密码。

例如，以下命令将授予用户 "myuser" 在数据库 "mydatabase" 的表 "mytable" 上的 SELECT 和 INSERT 权限：

```sql
GRANT SELECT, INSERT ON mydatabase.mytable TO 'myuser'@'localhost' IDENTIFIED BY 'mypassword';
```

授权成功后，用户将具有相应的权限来操作指定的数据库和表。